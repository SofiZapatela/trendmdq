<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"/>
  <link rel="icon" type="image/png" href="fotos/logo claro.png">
  <title>Trend MDQ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


  <!-- Poppins desde Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<meta property="og:title" content="Trend Mdq" />
<meta property="og:description" content="Ropa hermosa para personas que cuidan el ambiente!" />
<meta property="og:image" content="https://trendmdq.vercel.app/fotos/logo.png" />
<meta property="og:url" content="https://trendmdq.vercel.app/" />
<meta property="og:type" content="website" />

</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="index.html#hero">
  <img src="fotos/logo.png" alt="Logo Trend">
</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-end text-end" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" href="#inicio">Inicio</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#productos">Productos</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#tejidos">Tejidos</a>
        </li> 
        <li class="nav-item">
          <a class="nav-link" href="nosotros.html">Nosotros</a>
        </li> 
        <li class="nav-item">
          <a class="nav-link" href="#contacto">Contacto</a>
        </li>
      </ul>
    </div>
  </div>
</nav>




<header class="hero">
  <div class="hero-overlay"></div>
  <img src="fotos/fondo mar.webp" alt="fondo mar" class="hero-bg">
  <div class="hero-text">
    <img src="fotos/logo claro.png" alt="logo">
    <h1 class="brand">
      Trend
      <span class="sub">MDQ</span>
    </h1>
  </div>
</header>


  <!-- CARRUSEL -->
<section class="carrousel-container">
  <div class="carrousel">
    <h2>NUEVOS INGRESOS</h2>
    <div class="swiper mySwiper">
      <div class="swiper-wrapper">
        <div class="swiper-slide"><img src="fotos/blusa-amalfi.webp" alt="Nuevo 1"></div>
        <div class="swiper-slide"><img src="fotos/blusa-jean.jpeg" alt="Nuevo 2"></div>
        <div class="swiper-slide"><img src="fotos/mono-leopardo.jpeg" alt="Nuevo 3"></div>
        <div class="swiper-slide"><img src="fotos/mono-taxi.jpeg" alt="Nuevo 4"></div>
        <div class="swiper-slide"><img src="fotos/vestido-cielo.jpeg" alt="Nuevo 5"></div>
        <div class="swiper-slide"><img src="fotos/vestido-nube.jpeg" alt="Nuevo 6"></div>
        <div class="swiper-slide"><img src="fotos/vestido-fuego.jpeg" alt="Nuevo 7"></div>
        <div class="swiper-slide"><img src="fotos/vestido-esperanza.jpeg" alt="Nuevo 8"></div>
      </div>
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
    </div>
  </div>
</section>

 <!-- Contenedor general de productos y filtros -->
<section id="productos-container">

  <!-- filtros -->
  <div class="filtros-container">
    <button class="filtro-btn">
      <i class="fas fa-filter filtro-icon"></i> Filtros
    </button>

    <div id="filtros-card" class="filtros-card oculto">
      <select id="filtro-tipo" class="form-select">
        <option value="">Tipo de prenda</option>
        <option value="vestido">Vestido</option>
        <option value="blusa">Blusa</option>
        <option value="pantalon">Pantal√≥n</option>
        <option value="campera">Campera</option>
        <option value="mono">Mono</option>
        <option value="falda">Falda</option>
        <option value="conjunto">Conjunto</option>
        <option value="chaqueta">Chaqueta</option>
        <option value="zapatos">Zapatos</option>
        <option value="Accesorios">Accesorios</option>
      </select>

      <select id="filtro-talle" class="form-select">
        <option value="">Talle</option>
        <option value="S">S</option>
        <option value="M">M</option>
        <option value="L">L</option>
        <option value="XL">XL</option>
        <option value="XXL">XXL</option>
        <option value="36">36 zapatos</option>
        <option value="37">37 zapatos</option>
        <option value="38">38 zapatos</option>
        <option value="39">39 zapatos</option>
      </select>

      <select id="filtro-precio" class="form-select">
        <option value="">Ordenar por precio</option>
        <option value="asc">Menor a mayor</option>
        <option value="desc">Mayor a menor</option>
      </select>
    </div>
  </div>

  <!-- Grid para productos -->
  <h2>Nuestros Productos</h2>
  <section id="productos" class="grid-productos"></section>
  <div id="sentinel-productos"></div>
  <!-- Grid para tejidos -->
  <h2>Nuestros Tejidos</h2>

  <section id="tejidos" class="grid-productos" style="margin-top: 50px;"></section>
  <div id="sentinel-tejidos"></div>
</section>


<div style="max-width: 700px; margin: 40px auto; background-color: #F5EBDD; color: #29899b; padding: 20px 25px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-align: center; font-family: PlayfairDisplay, sans-serif;">
  <h3 style="margin: 0;">üì¶ Hacemos envios a todo el pa√≠s por Correo Argentino</h3>
</div>



  <!-- CONTACTO -->
  <section id="contacto">
    <h2>Contacto</h2>
    <p>Consultas al Whatsapp</p>
    <a href="https://wa.me/2233393119" target="_blank">COMPRA AC√Å</a>
  </section>

<footer style="text-align:center; padding: 20px; background-color: #29899b; color: #F5EBDD; font-family: Arial, sans-serif;">
  <p style="margin:0;">&copy; 2025 Trend Mdq</p>
  <div style="margin-top:10px; display: flex; justify-content: center; align-items: center; gap: 25px;">
    
    <!-- Instagram -->
    <a href="https://www.instagram.com/trendmdq/" target="_blank" rel="noopener noreferrer" style="color:#F5EBDD; font-size: 24px; text-decoration:none;">
      <i class="fab fa-instagram" aria-hidden="true"></i><span class="sr-only">Instagram</span>
    </a>
    
    <!-- Ubicaci√≥n sin link -->
    <div style="color:#F5EBDD; display: inline-flex; align-items: center; font-size: 18px;">
      <i class="fas fa-map-marker-alt" aria-hidden="true" style="font-size: 22px; margin-right: 6px;"></i>
      <span>Mar del Plata</span>
    </div>
    
  </div>
</footer>



  <!-- Swiper JS -->

<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
  <script>
    const swiper = new Swiper('.mySwiper', {
      loop: true,
      slidesPerView: 2, // valor por defecto (mobile primero)
      spaceBetween: 20,
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      autoHeight: true,
      breakpoints: {
        480: { slidesPerView: 2 },
        768: { slidesPerView: 3 },
        1024: { slidesPerView: 4 },
      }
    });
  </script>

  
<!-- FIREBASE -->

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAMYXqevFiswKZVICllkDVq2ymj6EgBn6I",
    authDomain: "trendmdq-4e495.firebaseapp.com",
    projectId: "trendmdq-4e495",
    storageBucket: "trendmdq-4e495.appspot.com",
    messagingSenderId: "866820424354",
    appId: "1:866820424354:web:548df9c9c21a881a354dfb"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  document.addEventListener("DOMContentLoaded", () => {

    /* -------------------------
       ELEMENTOS DEL DOM
    ------------------------- */
    const filtroTipo = document.getElementById("filtro-tipo");
    const filtroTalle = document.getElementById("filtro-talle");
    const filtroPrecio = document.getElementById("filtro-precio");

    const contProductos = document.getElementById("productos");
    const contTejidos = document.getElementById("tejidos");

    const sentinelProductos = document.getElementById("sentinel-productos");
    const sentinelTejidos = document.getElementById("sentinel-tejidos");

    const ITEMS_POR_CARGA = 12;

    /* -------------------------
   TOGGLE VISUAL FILTROS (BOT√ìN)
   Pegar dentro de DOMContentLoaded
------------------------- */
  const filtroBtn = document.querySelector('.filtro-btn');
  const filtrosCard = document.getElementById('filtros-card');

  // safety: si no existen, no rompe
  if (filtroBtn && filtrosCard) {
    // Evitar que clicks dentro del card cierren inmediatamente
    filtrosCard.addEventListener('click', (e) => e.stopPropagation());

    // Toggle al click del bot√≥n
    filtroBtn.addEventListener('click', (e) => {
      e.stopPropagation(); // que no burbujee al document
      filtrosCard.classList.toggle('oculto');
      filtrosCard.classList.toggle('active');
    });

    // Cerrar al clickear afuera
    document.addEventListener('click', (e) => {
      if (!filtrosCard.classList.contains('oculto') &&
          !filtrosCard.contains(e.target) &&
          !filtroBtn.contains(e.target)
      ) {
        filtrosCard.classList.add('oculto');
        filtrosCard.classList.remove('active');
      }
    });

    // Opcional: cerrar con ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === "Escape") {
        filtrosCard.classList.add('oculto');
        filtrosCard.classList.remove('active');
      }
    });
  }


    /* -------------------------
       ESTADOS
    ------------------------- */
    let cacheProductos = [];
    let cacheTejidos = [];

    let filtradosProductos = [];
    let filtradosTejidos = [];

    let lastDocProductos = null;
    let lastDocTejidos = null;


    /* -------------------------
       CREAR TARJETA DE PRODUCTO
    ------------------------- */
    function crearTarjeta(p) {
    const div = document.createElement("div");
    div.className = "producto";
    

    let imgSrc = Array.isArray(p.img || p.imagen)
      ? (p.img || p.imagen)[0]
      : p.img || p.imagen || "";

    if (imgSrc.includes("firebasestorage.googleapis.com")) {
      imgSrc += "&width=600";
    }

    div.innerHTML = `
      <a href="${p.href || '#'}" rel="noopener noreferrer" style="text-decoration: none; color: inherit;">
        <h3>${p.titulo || p.nombre || ""}</h3>
        <img src="${imgSrc}" width="150" height="200" loading="lazy" decoding="async" />
        <p>${p.desc || p.descripcion || ""}</p>
        <p><strong>$${p.precio || ""}</strong></p>
      </a>
    `;

    // üî•üî•üî• SETEAR DATA *DESPU√âS* DEL innerHTML
    div.dataset.tipo = (p.tipo || "").toLowerCase();
    div.dataset.talle = Array.isArray(p.talle)
      ? p.talle.map(t => t.toUpperCase()).join(",")
      : "";
    div.dataset.precio = p.precio || "0";

    return div;
  }

    /* -------------------------
       CARGA INICIAL
    ------------------------- */
    async function cargarInicial(coleccion, cacheArr, setLastDoc, contenedor, destinoFiltrado) {
      const snap = await db.collection(coleccion).limit(ITEMS_POR_CARGA).get();

      snap.forEach(doc => {
        const data = doc.data();
        const card = crearTarjeta(data);
        cacheArr.push(card);
      });

      setLastDoc(snap.docs.length ? snap.docs[snap.docs.length - 1] : null);

      // Mostrar inicial sin filtrar
      destinoFiltrado.length = 0;
      destinoFiltrado.push(...cacheArr);
      renderizar(contenedor, destinoFiltrado);
    }


    /* -------------------------
       CARGA ADICIONAL
    ------------------------- */
    async function cargarMas(coleccion, lastDoc, cacheArr, destinoFiltrado, contenedor) {
      if (!lastDoc) return;

      const snap = await db.collection(coleccion)
        .startAfter(lastDoc)
        .limit(ITEMS_POR_CARGA)
        .get();

      snap.forEach(doc => cacheArr.push(crearTarjeta(doc.data())));

      lastDoc = snap.docs.length ? snap.docs[snap.docs.length - 1] : null;

      aplicarFiltros();

      return lastDoc;
    }


    /* -------------------------
       RENDER SIN REEMPLAZAR TODO
    ------------------------- */
    function renderizar(contenedor, arr) {
      // Contenedor vac√≠o ‚Üí insertamos todo
      contenedor.innerHTML = "";
      arr.forEach(el => contenedor.appendChild(el));
    }


    /* -------------------------
       FILTROS
    ------------------------- */
    function aplicarFiltros() {
      const tipo = filtroTipo.value.toLowerCase();
      const talle = filtroTalle.value.toUpperCase();
      const orden = filtroPrecio.value;

      function filtrar(arr) {
        return arr.filter(el => {
          const tipoOK = !tipo || el.dataset.tipo === tipo;
          const talles = el.dataset.talle.split(",");
          const talleOK = !talle || talles.includes(talle);
          return tipoOK && talleOK;
        });
      }

      function ordenar(arr) {
        if (!orden) return arr;
        return [...arr].sort((a, b) => {
          const A = parseInt(a.dataset.precio);
          const B = parseInt(b.dataset.precio);
          return orden === "asc" ? A - B : B - A;
        });
      }

      filtradosProductos = ordenar(filtrar(cacheProductos));
      filtradosTejidos = ordenar(filtrar(cacheTejidos));

      renderizar(contProductos, filtradosProductos);
      renderizar(contTejidos, filtradosTejidos);
    }


    /* -------------------------
       OBSERVER ‚Üí PAGINACI√ìN REAL
    ------------------------- */
    const observer = new IntersectionObserver(async entries => {
      for (const entry of entries) {
        if (entry.isIntersecting) {
          if (entry.target.id === "sentinel-productos") {
            lastDocProductos = await cargarMas(
              "productos",
              lastDocProductos,
              cacheProductos,
              filtradosProductos,
              contProductos
            );
          }
          if (entry.target.id === "sentinel-tejidos") {
            lastDocTejidos = await cargarMas(
              "tejidos",
              lastDocTejidos,
              cacheTejidos,
              filtradosTejidos,
              contTejidos
            );
          }
        }
      }
    });

    if (sentinelProductos) observer.observe(sentinelProductos);
    if (sentinelTejidos) observer.observe(sentinelTejidos);


    /* -------------------------
       EVENTOS FILTROS
    ------------------------- */
    filtroTipo.addEventListener("change", aplicarFiltros);
    filtroTalle.addEventListener("change", aplicarFiltros);
    filtroPrecio.addEventListener("change", aplicarFiltros);


    /* -------------------------
       EJECUTAR INICIALES
    ------------------------- */
    cargarInicial("productos", cacheProductos, d => lastDocProductos = d, contProductos, filtradosProductos);
    cargarInicial("tejidos", cacheTejidos, d => lastDocTejidos = d, contTejidos, filtradosTejidos);

  });
</script>



<!-- Bootstrap JS + Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
